<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StoreTic - Panel de Administraci√≥n</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="../static/css/styles.css"> 
</head>
<body>

    <div class="admin-layout" id="admin-layout">

        <div id="admin-login" class="admin-layout__login">
            <h2 class="admin-main__title" style="text-align: center; color: var(--color-primary);">Acceso de Administrador</h2>
            <form id="admin-login-form" class="admin-form" style="max-width: 400px; margin: 0 auto;">
                <div class="admin-form__group">
                    <label for="admin-user" class="admin-form__label"><i class="fas fa-user-shield"></i> Usuario:</label>
                    <input type="text" id="admin-user" name="admin-user" class="admin-form__input" value="admin" required>
                </div>
                <div class="admin-form__group">
                    <label for="admin-pass" class="admin-form__label"><i class="fas fa-lock"></i> Contrase√±a:</label>
                    <input type="password" id="admin-pass" name="admin-pass" class="admin-form__input" value="admin" required>
                </div>
                <button type="submit" class="admin-form__button" style="width: 100%;">Iniciar Sesi√≥n</button>
                <p style="margin-top: 15px; text-align: center; font-size: 0.9em; color: #6c757d;">Credenciales: user: admin; pasw: admin;</p>
            </form>
        </div>


        <div id="admin-content-container" style="display: none; width: 100%; display: flex;">
            
            <aside class="admin-sidebar">
                <div class="admin-sidebar__logo">StoreTic Admin</div>
                <ul class="admin-sidebar__menu">
                    <li class="admin-sidebar__menu-item"><a href="#" onclick="showAdminSection('dashboard')"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
                    <li class="admin-sidebar__menu-item"><a href="#" onclick="showAdminSection('products')"><i class="fas fa-box-open"></i> Lista de Productos</a></li>
                    <li class="admin-sidebar__menu-item"><a href="#" onclick="showAdminSection('add-product')"><i class="fas fa-plus-circle"></i> Agregar Producto</a></li>
                    <li class="admin-sidebar__menu-item"><a href="#" onclick="showAdminSection('requests')"><i class="fas fa-clipboard-list"></i> Solicitudes (Encargos)</a></li>
                    <li class="admin-sidebar__menu-item"><a href="#" onclick="showAdminSection('profile')"><i class="fas fa-user-circle"></i> Ver Perfil Admin</a></li>
                    <li class="admin-sidebar__menu-item"><a href="../index.html" target="_blank" style="background-color: var(--color-primary); margin-top: 20px;"><i class="fas fa-store"></i> Ver Tienda</a></li>
                    <li class="admin-sidebar__menu-item"><a href="#" onclick="adminLogout()" style="color: #ffc107;"><i class="fas fa-sign-out-alt"></i> Cerrar Sesi√≥n</a></li>
                </ul>
            </aside>

            <main class="admin-main">
                
                <section id="admin-dashboard" class="admin-section">
                    <h2 class="admin-main__title">Dashboard üìä</h2>
                    <div class="admin-stats">
                        <div class="admin-stats__card">
                            <div class="admin-stats__number" id="stats-productos">0</div>
                            <div class="admin-stats__label">Total de Productos</div>
                        </div>
                        <div class="admin-stats__card">
                            <div class="admin-stats__number" id="stats-encargos">0</div>
                            <div class="admin-stats__label">Nuevas Solicitudes (Encargos)</div>
                        </div>
                        <div class="admin-stats__card">
                            <div class="admin-stats__number">$<span id="stats-credit">500.00</span></div>
                            <div class="admin-stats__label">Cr√©dito User001 Restante</div>
                        </div>
                    </div>
                </section>

                <section id="admin-products" class="admin-section" style="display: none;">
                    <div class="admin-content__header">
                        <h2 class="admin-main__title">Lista de Todos los Productos</h2>
                        <button class="admin-content__add-button" onclick="showAdminSection('add-product')"><i class="fas fa-plus"></i> A√±adir Nuevo</button>
                    </div>
                    
                    <table class="admin-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nombre</th>
                                <th>Categor√≠a</th>
                                <th>Precio Base</th>
                                <th>Descuento</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="admin-product-table-body">
                            </tbody>
                    </table>
                </section>

                <section id="admin-add-product" class="admin-section" style="display: none;">
                    <h2 class="admin-main__title">Agregar Nuevo Producto ‚ûï</h2>
                    <p style="margin-bottom: 20px; color: #6c757d;">*Tutorial*: Rellena todos los campos para a√±adir un producto a la tienda. ¬°Recuerda el descuento es opcional!</p>
                    <form id="add-product-form" class="admin-form" onsubmit="addProduct(event)">
                        
                        <div class="admin-form__group">
                            <label for="product-name" class="admin-form__label">Nombre del Producto:</label>
                            <input type="text" id="product-name" name="product-name" class="admin-form__input" required>
                        </div>
                        
                        <div class="admin-form__group">
                            <label for="product-category" class="admin-form__label">Categor√≠a:</label>
                            <select id="product-category" name="product-category" class="admin-form__select" required>
                                <option value="Drones">Drones</option>
                                <option value="Wearables">Wearables</option>
                                <option value="Audio">Audio</option>
                                <option value="Accesorios">Accesorios</option>
                                <option value="Monitores">Monitores</option>
                                <option value="Fotograf√≠a">Fotograf√≠a</option>
                                <option value="Otro">Otro</option>
                            </select>
                        </div>

                        <div class="admin-form__group">
                            <label for="product-price" class="admin-form__label">Precio Base ($):</label>
                            <input type="number" step="0.01" min="0" id="product-price" name="product-price" class="admin-form__input" required>
                        </div>

                        <div class="admin-form__group">
                            <label for="product-discount" class="admin-form__label">Descuento ($):</label>
                            <input type="number" step="0.01" min="0" id="product-discount" name="product-discount" class="admin-form__input" value="0">
                        </div>
                        
                        <div class="admin-form__group">
                            <label for="product-features" class="admin-form__label">Caracter√≠sticas (Breve):</label>
                            <textarea id="product-features" name="product-features" class="admin-form__textarea" rows="3" required></textarea>
                        </div>

                        <div class="admin-form__group">
                            <label for="product-image" class="admin-form__label">URL de Imagen (Opcional):</label>
                            <input type="url" id="product-image" name="product-image" class="admin-form__input" placeholder="https://via.placeholder.com/600x400...">
                        </div>

                        <button type="submit" class="admin-form__button"><i class="fas fa-save"></i> Guardar Producto</button>
                    </form>
                </section>
                
                <section id="admin-requests" class="admin-section" style="display: none;">
                    <h2 class="admin-main__title">Solicitudes de Compra (Encargos) üõí</h2>
                    <p style="margin-bottom: 20px; color: #6c757d;">Aqu√≠ se visualizan las compras simuladas que realizan los usuarios (user001) desde el carrito.</p>
                    <div id="admin-requests-container">
                        </div>
                </section>

                <section id="admin-profile" class="admin-section" style="display: none;">
                    <h2 class="admin-main__title">Perfil del Administrador üë§</h2>
                    <div style="background: white; padding: 20px; border-radius: 8px;">
                        <p><strong>Nombre de Usuario:</strong> admin</p>
                        <p><strong>Rol:</strong> Administrador Principal de StoreTic</p>
                        <p><strong>Funci√≥n:</strong> Gesti√≥n de inventario, seguimiento de encargos y mantenimiento general.</p>
                        <p style="margin-top: 15px; color: var(--color-admin-primary);">El panel de usuarios est√° simplificado en esta simulaci√≥n. Todas las interacciones se registran bajo el usuario por defecto: <strong>user001</strong>.</p>
                    </div>
                </section>

            </main>
        </div>

    </div>

    <script>
        // L√≥gica de visualizaci√≥n de secciones para admin.html (No BEM, simple JS)

        // Comprueba si el usuario est√° logeado al cargar
        const isLoggedIn = localStorage.getItem('isAdminLoggedIn') === 'true';
        if (isLoggedIn) {
            document.getElementById('admin-login').style.display = 'none';
            document.getElementById('admin-content-container').style.display = 'flex';
            
            // Inicializaci√≥n de datos del Admin (usa funciones de scripts.js)
            document.getElementById('stats-productos').textContent = JSON.parse(localStorage.getItem('products') || '[]').length;
            document.getElementById('stats-credit').textContent = parseFloat(localStorage.getItem('userCredit') || '500.00').toFixed(2);
            renderAdminRequests();
            renderAdminProductTable();
            showAdminSection('dashboard'); // Mostrar la secci√≥n inicial
        }

        function showAdminSection(sectionId) {
            // Ocultar todas las secciones
            document.querySelectorAll('.admin-section').forEach(section => {
                section.style.display = 'none';
            });
            // Mostrar la secci√≥n solicitada
            const targetSection = document.getElementById('admin-' + sectionId);
            if (targetSection) {
                targetSection.style.display = 'block';
            }
        }

        function adminLogout() {
            localStorage.removeItem('isAdminLoggedIn');
            alert('Has cerrado sesi√≥n como administrador.');
            window.location.reload();
        }

        // Se necesita cargar scripts.js para las funciones de gesti√≥n (addProduct, deleteProduct, renderAdminProductTable, renderAdminRequests)
    </script>
    <script src="../static/js/scripts.js"></script> 
</body>
</html>